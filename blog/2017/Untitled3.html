<html>
				<head>
				<meta charset="utf-8">
			    <meta http-equiv="X-UA-Compatible" content="IE=edge">
			    <meta name="viewport" content="width=device-width, initial-scale=1">
			    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			    <meta name="description" content="">
			    <meta name="author" content="">
			    <title>Nipun Batra</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


			      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            displayMath: [ ["$$",'$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
</head>
			    <body>
<nav class="navbar navbar-default">
    <div class="container text-center">

        <div id="navbar" class="navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="../../index.html">Home</a></li>
                <li><a href="../../publications.html">Publications</a></li>
                <li><a href="../index.html">Blog</a></li>
                <li><a href="../../files/cv.pdf">CV</a></li>
            </ul>
        </div>
    </div>
</nav>
			    <div class="container" margin="5%">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">unicode_literals</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="nb">open</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="k">def</span> <span class="nf">findFiles</span><span class="p">(</span><span class="n">path</span><span class="p">):</span> <span class="k">return</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">findFiles</span><span class="p">(</span><span class="s1">&#39;/Users/nipun/Downloads/data/names/*.txt&#39;</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">unicodedata</span>
<span class="kn">import</span> <span class="nn">string</span>

<span class="n">all_letters</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="s2">&quot; .,;&#39;&quot;</span>
<span class="n">n_letters</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_letters</span><span class="p">)</span>

<span class="c1"># Turn a Unicode string to plain ASCII, thanks to http://stackoverflow.com/a/518232/2809427</span>
<span class="k">def</span> <span class="nf">unicodeToAscii</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="s1">&#39;NFD&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">category</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;Mn&#39;</span>
        <span class="ow">and</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_letters</span>
    <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">unicodeToAscii</span><span class="p">(</span><span class="s1">&#39;Ślusàrski&#39;</span><span class="p">))</span>

<span class="c1"># Build the category_lines dictionary, a list of names per language</span>
<span class="n">category_lines</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">all_categories</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Read a file and split into lines</span>
<span class="k">def</span> <span class="nf">readLines</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">unicodeToAscii</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>

<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">findFiles</span><span class="p">(</span><span class="s1">&#39;/Users/nipun/Downloads/data/names/*.txt&#39;</span><span class="p">):</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">all_categories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">category</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">readLines</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">category_lines</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="n">lines</span>

<span class="n">n_categories</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_categories</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;/Users/nipun/Downloads/data/names/Czech.txt&#39;, &#39;/Users/nipun/Downloads/data/names/German.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Arabic.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Japanese.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Chinese.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Vietnamese.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Russian.txt&#39;, &#39;/Users/nipun/Downloads/data/names/French.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Irish.txt&#39;, &#39;/Users/nipun/Downloads/data/names/English.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Spanish.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Greek.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Italian.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Portuguese.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Scottish.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Dutch.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Korean.txt&#39;, &#39;/Users/nipun/Downloads/data/names/Polish.txt&#39;]
Slusarski
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_categories</span><span class="p">,</span> <span class="n">n_letters</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(18, 57)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">all_letters</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ .,;&#39;&#34;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">category_lines</span><span class="p">[</span><span class="s1">&#39;Arabic&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;Khoury&#39;, &#39;Nahas&#39;, &#39;Daher&#39;, &#39;Gerges&#39;, &#39;Nazari&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># Find letter index from all_letters, e.g. &quot;a&quot; = 0</span>
<span class="k">def</span> <span class="nf">letterToIndex</span><span class="p">(</span><span class="n">letter</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">all_letters</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span>

<span class="c1"># Just for demonstration, turn a letter into a &lt;1 x n_letters&gt; Tensor</span>
<span class="k">def</span> <span class="nf">letterToTensor</span><span class="p">(</span><span class="n">letter</span><span class="p">):</span>
    <span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_letters</span><span class="p">)</span>
    <span class="n">tensor</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">letterToIndex</span><span class="p">(</span><span class="n">letter</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">tensor</span>

<span class="c1"># Turn a line into a &lt;line_length x 1 x n_letters&gt;,</span>
<span class="c1"># or an array of one-hot letter vectors</span>
<span class="k">def</span> <span class="nf">lineToTensor</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_letters</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">li</span><span class="p">,</span> <span class="n">letter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
        <span class="n">tensor</span><span class="p">[</span><span class="n">li</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">letterToIndex</span><span class="p">(</span><span class="n">letter</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">tensor</span>

<span class="nb">print</span><span class="p">(</span><span class="n">letterToTensor</span><span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">lineToTensor</span><span class="p">(</span><span class="s1">&#39;Jones&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>

Columns 0 to 12 
    0     0     0     0     0     0     0     0     0     0     0     0     0

Columns 13 to 25 
    0     0     0     0     0     0     0     0     0     0     0     0     0

Columns 26 to 38 
    0     0     0     0     0     0     0     0     0     1     0     0     0

Columns 39 to 51 
    0     0     0     0     0     0     0     0     0     0     0     0     0

Columns 52 to 56 
    0     0     0     0     0
[torch.FloatTensor of size 1x57]

torch.Size([5, 1, 57])
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">letterToTensor</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>

Columns 0 to 12 
    0     1     0     0     0     0     0     0     0     0     0     0     0

Columns 13 to 25 
    0     0     0     0     0     0     0     0     0     0     0     0     0

Columns 26 to 38 
    0     0     0     0     0     0     0     0     0     0     0     0     0

Columns 39 to 51 
    0     0     0     0     0     0     0     0     0     0     0     0     0

Columns 52 to 56 
    0     0     0     0     0
[torch.FloatTensor of size 1x57]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lineToTensor</span><span class="p">(</span><span class="s1">&#39;batra&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>
(0 ,.,.) = 

Columns 0 to 18 
    0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Columns 19 to 37 
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Columns 38 to 56 
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

(1 ,.,.) = 

Columns 0 to 18 
    1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Columns 19 to 37 
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Columns 38 to 56 
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

(2 ,.,.) = 

Columns 0 to 18 
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Columns 19 to 37 
    1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Columns 38 to 56 
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

(3 ,.,.) = 

Columns 0 to 18 
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0

Columns 19 to 37 
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Columns 38 to 56 
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

(4 ,.,.) = 

Columns 0 to 18 
    1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Columns 19 to 37 
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Columns 38 to 56 
    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
[torch.FloatTensor of size 5x1x57]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">torch.autograd</span> <span class="k">import</span> <span class="n">Variable</span>

<span class="k">class</span> <span class="nc">RNN</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">,</span> <span class="n">output_size</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RNN</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span> <span class="o">=</span> <span class="n">hidden_size</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">i2h</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_size</span> <span class="o">+</span> <span class="n">hidden_size</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i2o</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_size</span> <span class="o">+</span> <span class="n">hidden_size</span><span class="p">,</span> <span class="n">output_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">softmax</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LogSoftmax</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">hidden</span><span class="p">):</span>
        <span class="n">combined</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="nb">input</span><span class="p">,</span> <span class="n">hidden</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">hidden</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">i2h</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">i2o</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span><span class="p">,</span> <span class="n">hidden</span>

    <span class="k">def</span> <span class="nf">initHidden</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Variable</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">))</span>

<span class="n">n_hidden</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rnn</span> <span class="o">=</span> <span class="n">RNN</span><span class="p">(</span><span class="n">n_letters</span><span class="p">,</span> <span class="n">n_hidden</span><span class="p">,</span> <span class="n">n_categories</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">input</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">letterToTensor</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">))</span>
<span class="n">hidden</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_hidden</span><span class="p">))</span>

<span class="n">output</span><span class="p">,</span> <span class="n">next_hidden</span> <span class="o">=</span> <span class="n">rnn</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">hidden</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">output</span><span class="p">,</span> <span class="n">next_hidden</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[75]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(Variable containing:
 
 Columns 0 to 9 
 -2.8098 -2.7964 -3.0780 -2.9578 -2.8856 -2.8655 -2.8620 -2.8942 -2.8240 -2.9100
 
 Columns 10 to 17 
 -2.9108 -2.8687 -2.9899 -2.7546 -3.0932 -2.8766 -2.8844 -2.8313
 [torch.FloatTensor of size 1x18], Variable containing:
  0.1059
 [torch.FloatTensor of size 1x1])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">next_hidden</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[76]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Variable containing:
 0.1059
[torch.FloatTensor of size 1x1]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">input</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">lineToTensor</span><span class="p">(</span><span class="s1">&#39;Albert&#39;</span><span class="p">))</span>
<span class="n">hidden</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_hidden</span><span class="p">))</span>

<span class="n">output</span><span class="p">,</span> <span class="n">next_hidden</span> <span class="o">=</span> <span class="n">rnn</span><span class="p">(</span><span class="nb">input</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hidden</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Variable containing:

Columns 0 to 9 
-2.8098 -2.7964 -3.0780 -2.9578 -2.8856 -2.8655 -2.8620 -2.8942 -2.8240 -2.9100

Columns 10 to 17 
-2.9108 -2.8687 -2.9899 -2.7546 -3.0932 -2.8766 -2.8844 -2.8313
[torch.FloatTensor of size 1x18]

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">categoryFromOutput</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="n">top_n</span><span class="p">,</span> <span class="n">top_i</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Tensor out of Variable with .data</span>
    <span class="n">category_i</span> <span class="o">=</span> <span class="n">top_i</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">all_categories</span><span class="p">[</span><span class="n">category_i</span><span class="p">],</span> <span class="n">category_i</span>

<span class="nb">print</span><span class="p">(</span><span class="n">categoryFromOutput</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(&#39;Portuguese&#39;, 13)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">randomChoice</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">l</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">randomTrainingExample</span><span class="p">():</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">randomChoice</span><span class="p">(</span><span class="n">all_categories</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">randomChoice</span><span class="p">(</span><span class="n">category_lines</span><span class="p">[</span><span class="n">category</span><span class="p">])</span>
    <span class="n">category_tensor</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">LongTensor</span><span class="p">([</span><span class="n">all_categories</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">category</span><span class="p">)]))</span>
    <span class="n">line_tensor</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">lineToTensor</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">category</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">category_tensor</span><span class="p">,</span> <span class="n">line_tensor</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">category</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">category_tensor</span><span class="p">,</span> <span class="n">line_tensor</span> <span class="o">=</span> <span class="n">randomTrainingExample</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;category =&#39;</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="s1">&#39;/ line =&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>category = Japanese / line = Kasaya
category = Irish / line = O&#39;Gorman
category = Polish / line = Filipek
category = English / line = Pickersgill
category = Spanish / line = Villa
category = English / line = Collins
category = Arabic / line = Tahan
category = Japanese / line = Kitamura
category = English / line = Newson
category = Scottish / line = Young
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">NLLLoss</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[81]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.005</span> <span class="c1"># If you set this too high, it might explode. If too low, it might not learn</span>

<span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">category_tensor</span><span class="p">,</span> <span class="n">line_tensor</span><span class="p">):</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="n">rnn</span><span class="o">.</span><span class="n">initHidden</span><span class="p">()</span>

    <span class="n">rnn</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">line_tensor</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">output</span><span class="p">,</span> <span class="n">hidden</span> <span class="o">=</span> <span class="n">rnn</span><span class="p">(</span><span class="n">line_tensor</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hidden</span><span class="p">)</span>

    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">category_tensor</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

    <span class="c1"># Add parameters&#39; gradients to their values, multiplied by learning rate</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">rnn</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
        <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="o">-</span><span class="n">learning_rate</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output</span><span class="p">,</span> <span class="n">loss</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">n_iters</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">print_every</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">plot_every</span> <span class="o">=</span> <span class="mi">1000</span>



<span class="c1"># Keep track of losses for plotting</span>
<span class="n">current_loss</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">all_losses</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">timeSince</span><span class="p">(</span><span class="n">since</span><span class="p">):</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">since</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">s</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">-=</span> <span class="n">m</span> <span class="o">*</span> <span class="mi">60</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">m </span><span class="si">%d</span><span class="s1">s&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_iters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">category</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">category_tensor</span><span class="p">,</span> <span class="n">line_tensor</span> <span class="o">=</span> <span class="n">randomTrainingExample</span><span class="p">()</span>
    <span class="n">output</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">category_tensor</span><span class="p">,</span> <span class="n">line_tensor</span><span class="p">)</span>
    <span class="n">current_loss</span> <span class="o">+=</span> <span class="n">loss</span>

    <span class="c1"># Print iter number, loss, name and guess</span>
    <span class="k">if</span> <span class="nb">iter</span> <span class="o">%</span> <span class="n">print_every</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">guess</span><span class="p">,</span> <span class="n">guess_i</span> <span class="o">=</span> <span class="n">categoryFromOutput</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="n">correct</span> <span class="o">=</span> <span class="s1">&#39;✓&#39;</span> <span class="k">if</span> <span class="n">guess</span> <span class="o">==</span> <span class="n">category</span> <span class="k">else</span> <span class="s1">&#39;✗ (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">category</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> </span><span class="si">%d%%</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">) </span><span class="si">%.4f</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> / </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">iter</span><span class="p">,</span> <span class="nb">iter</span> <span class="o">/</span> <span class="n">n_iters</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">timeSince</span><span class="p">(</span><span class="n">start</span><span class="p">),</span> <span class="n">loss</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">guess</span><span class="p">,</span> <span class="n">correct</span><span class="p">))</span>

    <span class="c1"># Add current loss avg to list of losses</span>
    <span class="k">if</span> <span class="nb">iter</span> <span class="o">%</span> <span class="n">plot_every</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">all_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_loss</span> <span class="o">/</span> <span class="n">plot_every</span><span class="p">)</span>
        <span class="n">current_loss</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>5000 5% (0m 8s) 2.8899 Salvail / Dutch ✗ (Italian)
10000 10% (0m 15s) 3.1629 Olguin / Irish ✗ (Spanish)
15000 15% (0m 22s) 2.6341 Arnold / Arabic ✗ (English)
20000 20% (0m 29s) 2.7647 Michael / Scottish ✗ (Irish)
25000 25% (0m 37s) 2.6895 Brabbery / English ✗ (Czech)
30000 30% (0m 44s) 3.0632 Garrastazu / Vietnamese ✗ (Spanish)
35000 35% (0m 51s) 1.6109 Fillipova / Czech ✓
40000 40% (0m 58s) 3.5562 Reynold / English ✗ (Irish)
45000 45% (1m 6s) 1.6764 Kawagichi / Italian ✗ (Japanese)
50000 50% (1m 13s) 2.8909 Jivlyuk / Polish ✗ (Russian)
55000 55% (1m 20s) 2.5617 Maria / Japanese ✗ (Portuguese)
60000 60% (1m 27s) 1.7002 Trnkova / Japanese ✗ (Czech)
65000 65% (1m 35s) 2.8060 Reijnders / Greek ✗ (Dutch)
70000 70% (1m 42s) 1.9980 Auttenberg / Polish ✓
75000 75% (1m 49s) 0.1234 Saksonov / Russian ✓
80000 80% (1m 56s) 0.6886 Egonidis / Greek ✓
85000 85% (2m 4s) 1.6078 Jong / Chinese ✗ (Korean)
90000 90% (2m 11s) 2.1896 Kouman / Irish ✗ (Dutch)
95000 95% (2m 18s) 2.3518 Mackenzie / French ✗ (Scottish)
100000 100% (2m 25s) 4.5430 Nacar / Arabic ✗ (Italian)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># Keep track of correct guesses in a confusion matrix</span>
<span class="n">confusion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_categories</span><span class="p">,</span> <span class="n">n_categories</span><span class="p">)</span>
<span class="n">n_confusion</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Just return an output given a line</span>
<span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">line_tensor</span><span class="p">):</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="n">rnn</span><span class="o">.</span><span class="n">initHidden</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">line_tensor</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">output</span><span class="p">,</span> <span class="n">hidden</span> <span class="o">=</span> <span class="n">rnn</span><span class="p">(</span><span class="n">line_tensor</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hidden</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output</span><span class="p">,</span> <span class="n">hidden</span>

<span class="c1"># Go through a bunch of examples and record which are correctly guessed</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_confusion</span><span class="p">):</span>
    <span class="n">category</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">category_tensor</span><span class="p">,</span> <span class="n">line_tensor</span> <span class="o">=</span> <span class="n">randomTrainingExample</span><span class="p">()</span>
    <span class="n">output</span><span class="p">,</span> <span class="n">hidden</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">line_tensor</span><span class="p">)</span>
    <span class="n">guess</span><span class="p">,</span> <span class="n">guess_i</span> <span class="o">=</span> <span class="n">categoryFromOutput</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">category_i</span> <span class="o">=</span> <span class="n">all_categories</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">category</span><span class="p">)</span>
    <span class="n">confusion</span><span class="p">[</span><span class="n">category_i</span><span class="p">][</span><span class="n">guess_i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Normalize by dividing every row by its sum</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_categories</span><span class="p">):</span>
    <span class="n">confusion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">confusion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">confusion</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Set up plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">confusion</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>

<span class="c1"># Set up axes</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">all_categories</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">all_categories</span><span class="p">)</span>

<span class="c1"># Force label at every tick</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-83-af5090253ab4&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     37</span> 
<span class="ansi-green-intense-fg ansi-bold">     38</span> <span class="ansi-red-fg"># Force label at every tick</span>
<span class="ansi-green-fg">---&gt; 39</span><span class="ansi-red-fg"> </span>ax<span class="ansi-blue-fg">.</span>xaxis<span class="ansi-blue-fg">.</span>set_major_locator<span class="ansi-blue-fg">(</span>ticker<span class="ansi-blue-fg">.</span>MultipleLocator<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     40</span> ax<span class="ansi-blue-fg">.</span>yaxis<span class="ansi-blue-fg">.</span>set_major_locator<span class="ansi-blue-fg">(</span>ticker<span class="ansi-blue-fg">.</span>MultipleLocator<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;ticker&#39; is not defined</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
RU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">input_line</span><span class="p">,</span> <span class="n">n_predictions</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&gt; </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">input_line</span><span class="p">)</span>
    <span class="n">output</span><span class="p">,</span> <span class="n">hidden</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">lineToTensor</span><span class="p">(</span><span class="n">input_line</span><span class="p">)))</span>

    <span class="c1"># Get top N categories</span>
    <span class="n">topv</span><span class="p">,</span> <span class="n">topi</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">topk</span><span class="p">(</span><span class="n">n_predictions</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_predictions</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">topv</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="n">category_index</span> <span class="o">=</span> <span class="n">topi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">%.2f</span><span class="s1">) </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">all_categories</span><span class="p">[</span><span class="n">category_index</span><span class="p">]))</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">value</span><span class="p">,</span> <span class="n">all_categories</span><span class="p">[</span><span class="n">category_index</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">hidden</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predict</span><span class="p">(</span><span class="s1">&#39;Tom&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
&gt; Tom
(-0.86) Vietnamese
(-1.11) Korean
(-1.81) Chinese
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt output_prompt">Out[95]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Variable containing:
 0.4287
[torch.FloatTensor of size 1x1]</pre>
</div>

</div>

</div>
</div>

</div>
 

</div><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-96903131-1', 'auto');
  ga('send', 'pageview');

</script>
<div class="container">
<div id="share" class="navbar-static-bottom"></div>


    <script>
        $("#share").jsSocials({
            shares: ["email", "twitter", "facebook", "googleplus", "linkedin", "pinterest", "stumbleupon", "whatsapp"]
        });
    </script>

<div id="disqus_thread"></div>

<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://nipunbatra-1.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                                
    

<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


</body></html>