<html>
				<head>
				<meta charset="utf-8">
			    <meta http-equiv="X-UA-Compatible" content="IE=edge">
			    <meta name="viewport" content="width=device-width, initial-scale=1">
			    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			    <meta name="description" content="">
			    <meta name="author" content="">
			    <title>Coin tosses and MCMC</title>
<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


			      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            displayMath: [ ["$$",'$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
</head>
			    <body>
<nav class="navbar navbar-default">
    <div class="container text-center">

        <div id="navbar" class="navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="../../index.html">Home</a></li>
                <li><a href="../../publications.html">Publications</a></li>
                <li><a href="../index.html">Blog</a></li>
                <li><a href="../../files/cv.pdf">CV</a></li>
            </ul>
        </div>
    </div>
</nav>
			    <div class="container" margin="5%">
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Coin-tosses-and-MCMC">Coin tosses and MCMC<a class="anchor-link" href="#Coin-tosses-and-MCMC">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the <a href="../em.html">previous post</a>, I had discussed regarding the EM algorithm from a programmer's perspective. That blog post sparked an interesting discussion on Twitter which has led to the current post.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thus, I started to investiage how good would MCMC methods perform in comparison to EM.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Problem-statement">Problem statement<a class="anchor-link" href="#Problem-statement">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For a detailed understanding, refer to the previous post. In short, the problem is as follows.</p>
<p>You have two coins - A and B. Both of them have their own biases (probability of obtaining a head (or a tail )). We pick a coin at random and toss it up 10 times. We repeat this procedure 5 times, totaling in 5 observation sets of 10 observations each. However, we are not told which coin was tossed. So, looking at the data and some rough initial guess about the respective coin biases, can we tell something about the likely biases? Let us work it up using PyMC.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Customary-imports">Customary imports<a class="anchor-link" href="#Customary-imports">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">pymc</span> <span class="kn">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="kn">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Observations">Observations<a class="anchor-link" href="#Observations">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We use 1 for Heads and 0 for tails.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># 5 observation sets of 10 observations each</span>
<span class="n">observations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">observations_flattened</span> <span class="o">=</span> <span class="n">observations</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Number-of-heads-in-each-obervation-set">Number of heads in each obervation set<a class="anchor-link" href="#Number-of-heads-in-each-obervation-set">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">n_heads_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">observations</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_heads_array</span><span class="p">)),</span><span class="n">n_heads_array</span><span class="o">.</span><span class="n">tolist</span><span class="p">());</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of heads vs Observation set&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Observation set&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;#Heads observed&quot;</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Ground-truth">Ground truth<a class="anchor-link" href="#Ground-truth">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The true sequence of coin tosses which was hidden from us. <code>True</code> indicated coin A and <code>False</code> indicates coin B.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Ground truth</span>
<span class="n">coins_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">False</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">,</span><span class="bp">True</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Number of observation sets and number of observations in each set. This allows us to modify data easily (as opposed to hard coding stuff).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">n_observation_sets</span> <span class="o">=</span> <span class="n">observations</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">n_observation_per_set</span> <span class="o">=</span> <span class="n">observations</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Model-for-the-problem-statement">Model for the problem statement<a class="anchor-link" href="#Model-for-the-problem-statement">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We pick up a simple prior on the bias of coin A.</p>
<p>$\theta_a$ ~  $\beta(h_a,t_a)$</p>
<p>Similarly, for coin B.</p>
<p>$\theta_b$ ~  $\beta(h_b,t_b)$</p>
<p>For any given observation set, we assign equal probability to it coming from coin A or B.</p>
<p>$coin choice$ ~  DiscreteUniform(0,1)</p>
<p>Thus, if coin choice is known, then the associated bias term is fixed.</p>
<p>$\theta$ = $\theta_a$ if $coin choice$ =1 else $\theta_b$</p>
<p>Like, we did in the previous post, we use Binomial distribution with the bias as $\theta$. For each observation set, we calculate the number of heads observed and model it as our observed variable <code>obs</code>.</p>
<p>$obs$ = Binomial(n_tosses_per_observation_set, p = $\theta$ )</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us draw this model using <code>daft</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">daft</span>

<span class="n">pgm</span> <span class="o">=</span> <span class="n">daft</span><span class="o">.</span><span class="n">PGM</span><span class="p">([</span><span class="mf">3.6</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">])</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">daft</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="s2">&quot;theta_a&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\theta_a$&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.8</span><span class="p">))</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">daft</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="s2">&quot;theta_b&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\theta_b$&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.2</span><span class="p">))</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">daft</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="s2">&quot;theta&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\theta$&quot;</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.8</span><span class="p">))</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">daft</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="s2">&quot;coin_choice&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;coin_choice&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.8</span><span class="p">))</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">daft</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="s2">&quot;obs&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;obs&quot;</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;theta_a&quot;</span><span class="p">,</span> <span class="s2">&quot;theta&quot;</span><span class="p">)</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;theta_b&quot;</span><span class="p">,</span> <span class="s2">&quot;theta&quot;</span><span class="p">)</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;coin_choice&quot;</span><span class="p">,</span> <span class="s2">&quot;theta&quot;</span><span class="p">)</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s2">&quot;theta&quot;</span><span class="p">,</span> <span class="s2">&quot;obs&quot;</span><span class="p">)</span>
<span class="n">pgm</span><span class="o">.</span><span class="n">render</span><span class="p">();</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
rkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following segment codes the above model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Prior on coin A (For now we choose 2 H, 2 T)</span>
<span class="n">theta_a</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;theta_a&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Prior on coin B (For now we choose 2 H, 2 T)</span>
<span class="n">theta_b</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;theta_b&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Choosing either A or B </span>
<span class="n">coin_choice_array</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">DiscreteUniform</span><span class="p">(</span><span class="s1">&#39;coin_choice&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">n_observation_sets</span><span class="p">)</span>

<span class="c1"># Creating a theta (theta_a if A is tossed or theta_b if B is tossed)</span>
<span class="nd">@pm.deterministic</span>
<span class="k">def</span> <span class="nf">theta</span><span class="p">(</span><span class="n">theta_a</span> <span class="o">=</span> <span class="n">theta_a</span><span class="p">,</span> <span class="n">theta_b</span><span class="o">=</span><span class="n">theta_b</span><span class="p">,</span> <span class="n">coin_choice_array</span><span class="o">=</span><span class="n">coin_choice_array</span><span class="p">):</span>
    <span class="c1">#print coin_choice_array</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_observation_sets</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coin_choice</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coin_choice_array</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">coin_choice</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta_a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta_b</span>                   
    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us examine how theta would be related to coin choice and other variables we have defined.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">theta_a</span><span class="o">.</span><span class="n">value</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[22]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array(0.46192564399429575)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">theta_b</span><span class="o">.</span><span class="n">value</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[23]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array(0.5918506713420255)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">coin_choice_array</span><span class="o">.</span><span class="n">value</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[24]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([1, 1, 0, 0, 1])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">theta</span><span class="o">.</span><span class="n">value</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[25]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([ 0.46192564,  0.46192564,  0.59185067,  0.59185067,  0.46192564])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, whenever we see coin A, we put it's bias in theta and likewise if we observe coin B. Now, let us create a model for our observations which is binomial as discussed above.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">observation_model</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Binomial</span><span class="p">(</span><span class="s2">&quot;obs&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n_observation_per_set</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">n_heads_array</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">([</span><span class="n">observation_model</span><span class="p">,</span> <span class="n">theta_a</span><span class="p">,</span> <span class="n">theta_b</span><span class="p">,</span> <span class="n">coin_choice_array</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us view a few samples from the <code>observation_model</code> which returns the number of heads in 5 sets of 10 tosses.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">observation_model</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[28]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([4, 4, 7, 2, 6])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">observation_model</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[29]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([4, 4, 7, 5, 2])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">mcmc</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">MCMC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">40000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre> [-----------------100%-----------------] 40000 of 40000 complete in 7.8 sec</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us have a look at our posteriors for $\theta_a$ and $\theta_b$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mcmc</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s1">&#39;theta_a&#39;</span><span class="p">)[:],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\theta_a$&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mcmc</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s1">&#39;theta_b&#39;</span><span class="p">)[:],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\theta_b$&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
d+wtSi78DKGwrad4RCRjCoA8MSKlBAuKiAbf+otP8ST9PuxPmLQ64EuSCLyvp3hEZEJyHgC2bfPQ
Qw/x+99u2y/1AAAGMUlEQVT/nkAgwKOPPsqll16a691OGsdxiEYH02oTjUZJxGM4tk0g8pef4vH7
ffg+IQD0FI/I9OU4NoODg/zhD38gFMpsRrG5cz+PzzfxeYVzHgAvvvgiw8PDPPPMM7z22mts27aN
J598Mte7nTTR6CAv/aGTojQexRwcPMmpUC/RuKW/4EVcxooPcei1AX5V0EuREUm7vXnyBN/66xuZ
P3/BhGvJeQB0dXWxYsUKAJYsWcLrr7+e612OaaKDqQF86lOfxus9/RBVUXExRtgYd9uknSRYVIRH
D2GJuFIgWERoVilGZFZe68h5AJimec5ljs/nw7btkZNnPnx0MDXHcUa9EftJYoMD3LRyHmVlczBN
k5PJkyTt5LjbDw6m95WRiEgu5DwAQqEQsdjZ8WqydfLf8/1/48SfTnIqPkTf8fT+mo+fGmLIW0bJ
BRfiwYP3Qgt/MDju9qbvON/72f+lsNDgVDRK0CiksDg87vax6AkKQxEcy8Yb8JIaHv7E9Xx+D6mk
c/7+T57AFwiO2f4v1j8N23+0L6Zj/dlsP2Se4FR0CI/HSbvtmf1bQ/EZ0R4n+Ym/I5O1/3y1z5ac
B0BlZSUvv/wy1157Lb/5zW9YsGDs763KysY+mW5t/GY2yhMRcS2P4zjpxWeaHMfhoYceoru7G4DH
HnuMz33uc7ncpYiIjEPOA0BERKYmPYYiIuJSCgAREZdSAIiIuJQCQETEpfISALZt8+CDD3LLLbdw
22238e67757z85deeombbrqJW265hWeffTYfJU6asfrihRde4Oabb6a2tpbm5mZm8j37sfrijK1b
t9LS0jLJ1U2usfriyJEjrF+/nrq6Ou6//34sy8pTpbk3Vl/893//NzfeeCM33XQTbW1teapycr32
2mvcdttt5y1P+9zp5MFPf/pTp7Gx0XEcx/nNb37j1NfXj/zMsixnzZo1zuDgoGNZlnPjjTc6/f39
+ShzUozWF6dOnXJWr17txONxx3Ecp6Ghwdm/f39e6pwMo/XFGW1tbc66deuclpaWyS5vUo3WF7Zt
O9dff73z7rvvOo7jOO3t7U5PT09e6pwMY30uVq1a5Zw8efKcc8dM9r3vfc+57rrrnHXr1p2zPJNz
Z16uAEYbH6inp4dLL72UcDhMIBDgiiuu4Be/+EU+ypwUo/VFQUEB7e3tFBQUAJBMJilMcwL46WSs
caO6uro4cuQI69atm9FXQjB6X7z11lvMmjWLH/zgB9x2220MDg5y+eWX56vUnBvrcxEIBBgcHCSR
SOA4Dh6PJx9lTpry8nJ27tx53u9AJufOvATAXxof6MzPwuGzbwIbhkE0Gp30GifLaH3h8XgoLS0F
oLW1lVOnTrF8+fK81DkZRuuLDz/8kF27dvHggw/O+JM/jN4XJ06c4Ne//jW33norP/jBDzh06BA/
//nP81Vqzo3WFwC33347N954I9dddx2rVq3KeIjl6eKaa675xKGgMzl35iUARhsfKBwOn/OzWCxG
SUnJpNc4WcYaK8m2bR5//HEOHTrEd7/73XyUOGlG64uf/vSnnDhxgrvvvpunnnqKF154geeeey5f
pebcaH0xa9YsLr30Ui6//HL8fj8rVqyYEqPs5spofXHs2DGefvppXnrpJV566SUGBgb4yU9+kq9S
8yqTc2deAqCyspLOzk6A88YHuvzyy3nnnXc4efIklmXxi1/8gi996Uv5KHNSjNYXAA8++CCWZbFr
166Rr4JmqtH64rbbbqOjo4PW1lbuuecerrvuOr7+9a/nq9ScG60vPvvZzzI0NDRyM/RXv/oV8+bN
y0udk2G0vkgkEni9XoLBIF6vl9LS0hn9jcFoMjl35mVKyDVr1nDgwAFuueUW4PT4QC+88AJDQ0Pc
fPPNNDY2cuedd2LbNjfddBNz5szJR5mTYrS+WLx4Mf/xH//B0qVL2bBhAwB/93d/x+rVq/NZcs6M
9bn4qJn+Pe9YffHoo4/yrW99C8dxqKys5Ctf+UqeK86dsfrihhtu4JZbbqGgoIDy8nJuuOGGPFc8
Oc78Dkzk3KmxgEREXEovgomIuJQCQETEpRQAIiIupQAQEXEpBYCIiEspAEREXEoBICLiUgoAERGX
+v8xrbU4/xDhjwAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looks like both $\theta_a$ and $\theta_b$ peak around the same value. But, wasn't it expected? We gave both of them the same priors.
This was also the case when we initialed EM with same values for both $\theta_a$ and $\theta_b$. So, let us add some informative priors an see how we do.
Like in EM experiment, we knew that one of the coin was more biased than the other. So, let us make that the case and rerun the experiment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="More-informative-priors">More informative priors<a class="anchor-link" href="#More-informative-priors">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Prior on coin A (more likely to have heads)</span>
<span class="n">theta_a</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;theta_a&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Prior on coin B (more likely to have tails)</span>
<span class="n">theta_b</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;theta_b&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Choosing either A or B (for 5 observations)</span>
<span class="n">coin_choice_array</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">DiscreteUniform</span><span class="p">(</span><span class="s1">&#39;coin_choice&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># Creating a theta (theta_a if A is tossed or theta_b if B is tossed)</span>
<span class="nd">@pm.deterministic</span>
<span class="k">def</span> <span class="nf">theta</span><span class="p">(</span><span class="n">theta_a</span> <span class="o">=</span> <span class="n">theta_a</span><span class="p">,</span> <span class="n">theta_b</span><span class="o">=</span><span class="n">theta_b</span><span class="p">,</span> <span class="n">coin_choice_array</span><span class="o">=</span><span class="n">coin_choice_array</span><span class="p">):</span>
    <span class="c1">#print coin_choice_array</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_observation_sets</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coin_choice</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coin_choice_array</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">coin_choice</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta_a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta_b</span>                   
    <span class="k">return</span> <span class="n">out</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">observation_model</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Binomial</span><span class="p">(</span><span class="s2">&quot;obs&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">n_heads_array</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">([</span><span class="n">observation_model</span><span class="p">,</span> <span class="n">theta_a</span><span class="p">,</span> <span class="n">theta_b</span><span class="p">,</span> <span class="n">coin_choice_array</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">mcmc</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">MCMC</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">40000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre> [-----------------100%-----------------] 40000 of 40000 complete in 8.0 sec</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mcmc</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s1">&#39;theta_a&#39;</span><span class="p">)[:],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\theta_a$&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mcmc</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s1">&#39;theta_b&#39;</span><span class="p">)[:],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\theta_b$&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Quiet a clear distinction now! $\theta_a$ seems to peak around 0.8 and $\theta_b$ around 0.5. This matches our results from EM. However, unlike EM, we have much more than point estimates.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Feel free to leave your comments and suggestions by.</p>

</div>
</div>
</div>
 

</div><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-96903131-1', 'auto');
  ga('send', 'pageview');

</script>
<div class="container">
<div id="share" class="navbar-static-bottom"></div>


    <script>
        $("#share").jsSocials({
            shares: ["email", "twitter", "facebook", "googleplus", "linkedin", "pinterest", "stumbleupon", "whatsapp"]
        });
    </script>

<div id="disqus_thread"></div>

<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://nipunbatra-1.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                                
    

<link rel="stylesheet" href="../../assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../assets/css/nipun-custom.css" />
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css" />
<link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


</body></html>